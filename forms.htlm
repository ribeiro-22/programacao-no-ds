<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Clientes</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, select, button { margin: 5px 0; display: block; width: 300px; }
    #listBoxClientes { height: 100px; }
  </style>
</head>
<body>
  <h2>Cadastro de Clientes</h2>

  <label for="listBoxClientes">Clientes:</label>
  <select id="listBoxClientes" size="5"></select>
  <button onclick="buscarCliente()">Buscar Cliente</button>

  <h3>Dados do Cliente</h3>
  <input type="text" id="txtNome" placeholder="Nome">
  <input type="text" id="txtEndereco" placeholder="Endereço">
  <input type="text" id="txtTelefone" placeholder="Telefone">
  <input type="email" id="txtEmail" placeholder="Email">

  <button onclick="incluirCliente()">Incluir Cliente</button>
  <button onclick="alterarCliente()">Alterar Cliente</button>

  <div id="botaoLimparContainer"></div>

  <script>
    // Inicialização
    if (!localStorage.getItem("clientes")) {
      const clientesIniciais = [
        { id: 1, nome: "João Silva", endereco: "Rua A", telefone: "123456", email: "joao@gmail.com" },
        { id: 2, nome: "Maria Oliveira", endereco: "Rua B", telefone: "654321", email: "maria@gmail.com" }
      ];
      localStorage.setItem("clientes", JSON.stringify(clientesIniciais));
    }

    const listBox = document.getElementById("listBoxClientes");

    function carregarLista() {
      listBox.innerHTML = "";
      const listaClientes = JSON.parse(localStorage.getItem("clientes")) || [];
      listaClientes.forEach(cliente => {
        const option = document.createElement("option");
        option.value = cliente.id;
        option.textContent = `${cliente.id} - ${cliente.nome}`;
        listBox.appendChild(option);
      });
    }

    function buscarCliente() {
      const listaClientes = JSON.parse(localStorage.getItem("clientes")) || [];
      const selectedId = parseInt(listBox.value);
      const cliente = listaClientes.find(c => c.id === selectedId);
      if (cliente) {
        document.getElementById("txtNome").value = cliente.nome;
        document.getElementById("txtEndereco").value = cliente.endereco;
        document.getElementById("txtTelefone").value = cliente.telefone;
        document.getElementById("txtEmail").value = cliente.email;
      }
    }

    function validarCampos() {
      const nome = document.getElementById("txtNome").value.trim();
      const endereco = document.getElementById("txtEndereco").value.trim();
      const telefone = document.getElementById("txtTelefone").value.trim();
      const email = document.getElementById("txtEmail").value.trim();
      return nome && endereco && telefone && email;
    }

    function incluirCliente() {
      if (!validarCampos()) {
        alert("Preencha todos os campos antes de incluir.");
        return;
      }

      const listaClientes = JSON.parse(localStorage.getItem("clientes")) || [];
      const novoId = listaClientes.length ? Math.max(...listaClientes.map(c => c.id)) + 1 : 1;

      const novoCliente = {
        id: novoId,
        nome: document.getElementById("txtNome").value.trim(),
        endereco: document.getElementById("txtEndereco").value.trim(),
        telefone: document.getElementById("txtTelefone").value.trim(),
        email: document.getElementById("txtEmail").value.trim()
      };

      listaClientes.push(novoCliente);
      localStorage.setItem("clientes", JSON.stringify(listaClientes));
      carregarLista();
      limparCampos();
    }

    function alterarCliente() {
      const selectedId = parseInt(listBox.value);
      if (isNaN(selectedId)) {
        alert("Selecione um cliente para alterar.");
        return;
      }

      if (!validarCampos()) {
        alert("Preencha todos os campos antes de alterar.");
        return;
      }

      const listaClientes = JSON.parse(localStorage.getItem("clientes")) || [];
      const clienteIndex = listaClientes.findIndex(c => c.id === selectedId);
      if (clienteIndex !== -1) {
        listaClientes[clienteIndex] = {
          id: selectedId,
          nome: document.getElementById("txtNome").value.trim(),
          endereco: document.getElementById("txtEndereco").value.trim(),
          telefone: document.getElementById("txtTelefone").value.trim(),
          email: document.getElementById("txtEmail").value.trim()
        };
        localStorage.setItem("clientes", JSON.stringify(listaClientes));
        carregarLista();
        limparCampos();
      }
    }

    function limparCampos() {
      document.getElementById("txtNome").value = "";
      document.getElementById("txtEndereco").value = "";
      document.getElementById("txtTelefone").value = "";
      document.getElementById("txtEmail").value = "";
    }

    // Criar botão "Limpar campos" via JavaScript
    const botaoLimpar = document.createElement("button");
    botaoLimpar.textContent = "Limpar campos";
    botaoLimpar.onclick = limparCampos;
    document.getElementById("botaoLimparContainer").appendChild(botaoLimpar);

    // Carregar lista ao iniciar
    carregarLista();
  </script>
</body>
</html>
